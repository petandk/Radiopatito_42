// ==UserScript==
// @name        Radiopatito 42 Minimal
// @namespace   Violentmonkey Scripts
// @match       https://*.intra.42.fr/*
// @grant       none
// @version     1.0
// @author      you
// @description Simple mobile version
// ==/UserScript==

(function() {
    'use strict';
    
    console.log('Radiopatito loaded');
    
    // Simple check for clusters page
    function isClustersPage() {
        return window.location.href.indexOf('/clusters') > -1;
    }
    
    // Create simple button
    function createButton() {
        var btn = document.createElement('button');
        btn.textContent = isClustersPage() ? 'Show Grid' : 'Go to Clusters';
        btn.style.position = 'fixed';
        btn.style.bottom = '20px';
        btn.style.right = '20px';
        btn.style.zIndex = '99999';
        btn.style.padding = '10px';
        btn.style.background = '#D8636F';
        btn.style.color = 'white';
        btn.style.border = 'none';
        btn.style.borderRadius = '5px';
        btn.style.cursor = 'pointer';
        
        if (isClustersPage()) {
            btn.onclick = showGrid;
        } else {
            btn.onclick = function() {
                window.location.href = 'https://meta.intra.42.fr/clusters';
            };
        }
        
        document.body.appendChild(btn);
    }
    
    // Simple grid display
    function showGrid() {
        var images = document.querySelectorAll('image[href]');
        if (images.length === 0) {
            alert('No images found');
            return;
        }
        
        // Remove existing grid
        var existing = document.getElementById('simple-grid');
        if (existing) {
            existing.remove();
            return;
        }
        
        var container = document.createElement('div');
        container.id = 'simple-grid';
        container.style.position = 'fixed';
        container.style.top = '10px';
        container.style.left = '10px';
        container.style.right = '10px';
        container.style.bottom = '10px';
        container.style.background = '#474b54';
        container.style.border = '2px solid #666';
        container.style.borderRadius = '10px';
        container.style.padding = '20px';
        container.style.zIndex = '100000';
        container.style.overflow = 'auto';
        
        var title = document.createElement('h2');
        title.textContent = 'Users: ' + images.length;
        title.style.color = 'white';
        title.style.textAlign = 'center';
        title.style.margin = '0 0 20px 0';
        
        var closeBtn = document.createElement('button');
        closeBtn.textContent = 'X';
        closeBtn.style.position = 'absolute';
        closeBtn.style.top = '10px';
        closeBtn.style.right = '10px';
        closeBtn.style.background = '#D8636F';
        closeBtn.style.color = 'white';
        closeBtn.style.border = 'none';
        closeBtn.style.borderRadius = '50%';
        closeBtn.style.width = '30px';
        closeBtn.style.height = '30px';
        closeBtn.style.cursor = 'pointer';
        closeBtn.onclick = function() {
            container.remove();
        };
        
        var grid = document.createElement('div');
        grid.style.display = 'grid';
        grid.style.gridTemplateColumns = 'repeat(auto-fill, minmax(200px, 1fr))';
        grid.style.gap = '10px';
        
        for (var i = 0; i < images.length; i++) {
            var img = images[i];
            var href = img.getAttribute('href');
            var login = img.getAttribute('data-tooltip-login') || 'Unknown';
            var id = img.getAttribute('id') || 'No ID';
            
            if (href) {
                var card = document.createElement('div');
                card.style.background = '#3a3e47';
                card.style.border = '1px solid #666';
                card.style.borderRadius = '5px';
                card.style.padding = '10px';
                card.style.textAlign = 'center';
                
                var image = document.createElement('img');
                image.src = href;
                image.style.width = '100px';
                image.style.height = '100px';
                image.style.objectFit = 'contain';
                image.style.border = '1px solid #666';
                image.style.borderRadius = '3px';
                
                var info = document.createElement('div');
                info.style.color = 'white';
                info.style.fontSize = '12px';
                info.style.marginTop = '5px';
                info.innerHTML = '<strong>' + login + '</strong><br>' + id;
                
                card.appendChild(image);
                card.appendChild(info);
                grid.appendChild(card);
            }
        }
        
        container.appendChild(title);
        container.appendChild(closeBtn);
        container.appendChild(grid);
        document.body.appendChild(container);
    }
    
    // Wait for page to load then create button
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', createButton);
    } else {
        createButton();
    }
    
})();
